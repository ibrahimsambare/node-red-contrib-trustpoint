<script type="text/javascript">
    RED.nodes.registerType('trustpoint-keygen', {
        category: 'Trustpoint',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            algorithm: { value: "RSA" },
            keySize: { value: "2048" },
            ecCurve: { value: "prime256v1" },
            persist: { value: false },
            filenamePrefix: { value: "keypair" }
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-key",
        label: function () {
            return this.name || "Key Generator";
        },
        oneditprepare: function () {
            function toggleVisibility() {
                const algo = $("#node-input-algorithm").val();
                if (algo === "RSA") {
                    $("#node-row-keySize").show();
                    $("#node-row-ecCurve").hide();
                } else {
                    $("#node-row-keySize").hide();
                    $("#node-row-ecCurve").show();
                }
            }

            $("#node-input-algorithm").on("change", toggleVisibility);
            toggleVisibility();
        }
    });
</script>

<style>
    .form-row label {
        width: 150px;
    }
</style>

<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="Optional name">
</div>

<div class="form-row">
    <label for="node-input-algorithm"><i class="fa fa-cog"></i> Algorithm</label>
    <select id="node-input-algorithm">
        <option value="RSA">RSA</option>
        <option value="EC">EC</option>
    </select>
</div>

<div class="form-row" id="node-row-keySize">
    <label for="node-input-keySize"><i class="fa fa-arrows-alt"></i> RSA Key Size</label>
    <input type="number" id="node-input-keySize" min="1024" step="256">
</div>

<div class="form-row" id="node-row-ecCurve">
    <label for="node-input-ecCurve"><i class="fa fa-superscript"></i> EC Curve</label>
    <input type="text" id="node-input-ecCurve" placeholder="e.g. prime256v1">
</div>

<div class="form-row">
    <label for="node-input-filenamePrefix"><i class="fa fa-save"></i> Filename Prefix</label>
    <input type="text" id="node-input-filenamePrefix" placeholder="keypair">
</div>

<div class="form-row">
    <label for="node-input-persist"><i class="fa fa-database"></i> Persist to file?</label>
    <input type="checkbox" id="node-input-persist">
</div>
